<html>

<head>
    <title>CrashNI // Map</title>
    <link rel="icon" type="image/png" href="img/favicon.png" />
    <link rel="shortcut icon" type="image/png" href="img/favicon.png" />
    <meta name="theme-color" content="#fdd700">

    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
    <style>
        @import url('css/font/stylesheet.css'); 

        body {
            background-color: #222;
        }

        .district-side {
            width: 60px;
            height:9.09%
        }

        .district-side > h1 {
            font-family: Uni Sans Heavy CAPS; 
            font-size: 2.2rem; 
            line-height: 230%; 
            white-space: nowrap; 
            margin-left: 90px; 
            display: none;
            color: #2c2c2c;
        }

        .data-unselected{
            color: #fdd70079; 
            font-family: Uni Sans Thin CAPS; 
            font-size: 2rem; 
            pointer-events: all;
            cursor: pointer;
        }

        .data-selected{
            color: #fdd700; 
            font-family: Uni Sans HEAVY CAPS;
        }
        ul {
          list-style-type: none;
          padding-left: 0;
        }

        .leaflet-container {
    background-color:rgba(255,0,0,0.0);
}
    
    </style>
    <div id="preload" style="position: fixed; height: 100%; width: 100%; background-color: #222; z-index: 1002; pointer-events: none;">
            <div class="h-100 d-flex justify-content-center align-items-center">
                <div class="row w-100 h-100 justify-content-center align-items-center">
                    <div class="col-xl-6">
    
                        <svg id="logo" fill="none" fill-rule="evenodd" stroke="white" stroke-width="1" viewBox="0 0 478.88 238.96">
                            <path class="cls-1" d="M296.23,120c.55-2.63.7-5.16-1.16-7.42a11.09,11.09,0,0,1-1.16-1.9,66,66,0,0,1-4.08-9.32,8,8,0,0,0-6.39-5.75,7.58,7.58,0,0,1-1.79-.5c-1.28-.59-1.51-1.06-1.28-2.43a13.14,13.14,0,0,1,1.16-3.06,7.4,7.4,0,0,0-5.63-10.45,10,10,0,0,1-4.46-1.81c-.13-.18,0-.51,0-.51.61-4.56,1.14-9.13,1.91-13.66.28-1.69.4-3.4.52-5.11a7.31,7.31,0,0,0-3.59-6.73,18.19,18.19,0,0,0-8.4-3.13,16.22,16.22,0,0,0-5.74.44,9.57,9.57,0,0,1-8.81-2.07,12.58,12.58,0,0,1-1.16-1.15c-2.6-2.73-5.77-3.31-9.31-2.41-1.16.29-2.3.68-3.45,1a8.62,8.62,0,0,1-7-1.17c-2-1.24-3.54-.88-5,.66-.52.55-1,1.09-1.53,1.66A9.37,9.37,0,0,1,214,48.15a39.82,39.82,0,0,0-12.38,4.09,29.79,29.79,0,0,1-11,3.23,28.5,28.5,0,0,1-11.23-1A22.22,22.22,0,0,1,174,52.24a3.22,3.22,0,0,0-.77-.29c-.42,0-.8,2.32-.8,2.32A61.32,61.32,0,0,1,168,68.82a19.26,19.26,0,0,1-3.84,6.25,11.28,11.28,0,0,1-10.34,3.4c-3.58-.55-7.08-1.62-10.71-1.83s-7.6-.23-11.08,1.42a10.76,10.76,0,0,0-6.45,7.87,19.82,19.82,0,0,1-6.47,10.73,8.49,8.49,0,0,1-1.28,1.13c-1.09.62-1.11,1.5-.9,2.57a20.9,20.9,0,0,1-.06,7.92,23.37,23.37,0,0,1-1.33,5.36,9.77,9.77,0,0,1-3.59,4.2c-4.23,2.79-6,6.8-6.28,11.75-.12,2.19.15,4.34.17,6.51,0,0,.26.92-.27,1.25-1,.12-1.8-.61-2.67-.87a13.69,13.69,0,0,0-12.65,2.16,16.68,16.68,0,0,1-4.7,2.73,5.43,5.43,0,0,1-5.38-.79,12.57,12.57,0,0,0-3.82-2.44,7.22,7.22,0,0,0-6.23,1.08c-4.44,2.86-5.16,7.69-2.69,12.07,2.3,4.08,6.18,5.68,10.57,6.4a13.8,13.8,0,0,1,5.89,2.14c1.28.91,2.33,1.88,2.34,3.57-1.19.45-2.34,0-3.51.11a11,11,0,0,0-9.53,9.11c-.13,1-.5,1.18-1.31,1.15l-16.34-.65c-1.15-.05-2.3-.16-3.45-.25-1.69-.15-2.27.31-2.15,2,.22,2.87-1.1,4.83-3.33,6.39a27.1,27.1,0,0,1-5.89,2.78,25.83,25.83,0,0,0-4.22,2.16,7,7,0,0,0-2.71,7.32c1,4.26,3.64,7.34,6.82,10.07,2.8,2.4,6.23,3.59,9.7,4.57,2.3.66,3.85,3.22,3.46,6.42-.29,2.42.94,4.19,2.79,5.61,1.1.85,2.47,1,3.71,1.52a6.75,6.75,0,0,1,3.47,2.42c1.26,1.92,1,4,.87,6s-.4,4,.23,6c.79,2.5,2.48,3.75,5,3.3a23.7,23.7,0,0,1,8.68-.21A17.09,17.09,0,0,1,88,245c1.68,1.82,3.15,3.83,4.89,5.58,2.7,2.72,5.82,4.78,9.8,5.14a7.12,7.12,0,0,0,4.87-1.27c1.51-1,3.07-2.15,5.09-1.29,1.07.46,2.15.9,3.19,1.41,3.37,1.64,6.72,3.32,10.09,5a3.92,3.92,0,0,0,.85.25,2.31,2.31,0,0,0,.56-1.9,26.7,26.7,0,0,0-.28-5.36c-.17-.77.27-1,.78-1a6.38,6.38,0,0,0,5.36-4.1,5,5,0,0,0,.26-2.17c0-2.07.63-2.7,2.68-2.94,3-.36,5.93-1,8.3-3.06,2.08-1.82,3.37-4,2.8-6.89a10.13,10.13,0,0,0-2.42-4.21,18.82,18.82,0,0,1-2.69-3.7c-1.53-3.43-.69-5.16,2-6.58a22.77,22.77,0,0,0,9-9.26,20.92,20.92,0,0,1,3.07-4.34,5.16,5.16,0,0,1,6.91-.78c4.89,3.17,9.87,6.21,14.79,9.35a5,5,0,0,1,2.3,5.48,25.37,25.37,0,0,0,2.17,16.21,19,19,0,0,0,9.32,9.59c2,.94,4.13,1.3,6.14,2.14,2.78,1.17,4.43,3.26,4.61,6.91.14,2.84-.6,5.55-1.07,8.29-.7,4.19.18,7.81,3.75,10.31,3.25,2.29,6.77,3,10.45.81a6.92,6.92,0,0,1,6.53-.44,19.74,19.74,0,0,0,9.55,1.21,2.42,2.42,0,0,0,.88-.38c.14-1.64-.29-3.3.52-4.87a8.39,8.39,0,0,1,6.65-4.42,15.05,15.05,0,0,1,11.11,2.24,15.25,15.25,0,0,1,4,4.08.54.54,0,0,0,.47.38l1-.23c2.42-.58,5.46.15,6,3.44a30.13,30.13,0,0,0,.87,3.19,4.33,4.33,0,0,0,4,3.3,5.34,5.34,0,0,0,3.68-1.28A180.17,180.17,0,0,0,288.64,263a6.53,6.53,0,0,0,1.65-4.94c-.14-3.58-.07-7.15-.06-10.72,0-3.11,1-5.89,3.82-7.51a13.64,13.64,0,0,1,8.15-1.52,86,86,0,0,0,9.07.75,12,12,0,0,0,7.9-3c4.84-4.15,3.21-18,3.19-18.11s-.08-.25-.08-.25-1.35-3.68-1.92-4c-2.94-1.47-3.22-2.78-6.28-1.92a3.83,3.83,0,0,1-2.05.29l-.38-.16a2.45,2.45,0,0,1,.75-1.8,18.56,18.56,0,0,0,4-7,16.34,16.34,0,0,0-.51-9.71c-1.44-4.24-3.76-8-6-11.87a8.89,8.89,0,0,1-.81-1.77,2.54,2.54,0,0,1,.43-2.81,2.84,2.84,0,0,1,2.93-.53,9.45,9.45,0,0,1,3.31,1.8c3.77,2.81,7.07,6,8.93,10.46,1.58,3.77,1.88,7.58,0,11.36a10.07,10.07,0,0,0-.38,10.08c.8,1.61,1.16,3.39,2.51,4.78a33.74,33.74,0,0,0,3.39,2.73c.67.53,1.42,0,2-.49a6.05,6.05,0,0,0,1.77-3.07q2.89-8.19,5.62-16.46c1-3,1-5.85-1.35-8.45s-4.82-10-5.37-13.33"
                                transform="translate(-33.13 -41.64)" />
                            <path class="cls-1" d="M177.49,164.08a20.81,20.81,0,0,1-18.62,11.61c-10.14,0-20.36-5.92-20.36-17.67V140.21c0-11.68,10.22-17.67,20.58-17.67,6.35,0,14,2.7,18.18,11.9l-10.66,4.31c-3.5-6.42-15-5-15,1.46V158c0,6.21,11.68,8,14.53.8Z"
                                transform="translate(-33.13 -41.64)" />
                            <path class="cls-1" d="M197.78,158.53h-2.33V175H182.23V123.27h20.66c10.66,0,18.91,4.89,19.2,17,0,9.56-3.87,15-10.15,16.94L226,175H209.75Zm5.33-11.24a5.92,5.92,0,1,0,0-11.83h-7.66v11.83Z"
                                transform="translate(-33.13 -41.64)" />
                            <path class="cls-1" d="M273.26,175h-14l-3.36-10.37h-13.8L238.88,175h-14l18-51.69h11.9Zm-20.51-22-3.58-15.11h-.36L245,153Z"
                                transform="translate(-33.13 -41.64)" />
                            <path class="cls-1" d="M281.66,158.6c5.18,6.28,16.57,6.57,16.93,1,.15-2.92-4.59-4.6-8.83-5.19-8.32-1.31-15.91-6.57-15.91-16.42,0-10.15,9.2-15.48,18.69-15.48,6.27,0,12.33,1.76,17.66,8.25l-8.54,6.57c-5.4-5.76-14.67-5.55-14.89.44.14,2.48,2.85,3.94,6.86,4.82,9.2,1.68,18.4,4.89,17.81,17.59-.44,10-10.95,15.48-20.44,15.48-6.2,0-12.77-3.14-17.59-9.35Z"
                                transform="translate(-33.13 -41.64)" />
                            <path class="cls-1" d="M330.2,175H317.06V123.27H330.2v19.57h14.89V123.27h13.14V175H345.09V155.47H330.2Z"
                                transform="translate(-33.13 -41.64)" />
                            <path class="cls-1" d="M379.7,123.27h12.41l12.48,22L409,155.68l.36-.07c-.07,0-1.38-8.9-1.46-8.9V123.27h13V175H407.65L396,154.59l-4.52-10.37-.37.08,1.68,10V175H379.7Z"
                                transform="translate(-33.13 -41.64)" />
                            <path class="cls-1" d="M442.11,175H429V123.27h13.07Z" transform="translate(-33.13 -41.64)" /></svg>
                        <h1 id="loading-text" class="text-white text-center pt-5">Loading... This could take some time...</h1>
                    </div>
                </div>
            </div>
    
        </div>
</head>

<body>

        <div id="page-selector" style="position: fixed; top:0; right: 0; text-align: right; margin-top: 30px; margin-right: 20px; z-index: 1001">
                <h1 class="data-unselected data-selected" style="float: right; margin-left: 10px">
                    MAP</h1>
                <img onclick="overviewPage()" src="img/switch_right.png" style="height: 3rem; float: right; transform: translateY(-0.5rem); cursor: pointer">
                <h1 onclick="overviewPage()"  id="" class="data-unselected" style="float: right; margin-right: 10px">
                    OVERVIEW</h1>
            </div>

    <div id="mapid" style="height: 100%; width:100%"></div>


    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    <script src="js/anime.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tilt.js/1.2.1/tilt.jquery.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.js"></script>

    <script>
        window.onload = () => {
            anime({
                    targets: "#preload",
                    opacity: "0",
                    easing: 'easeInOutQuart',
                    duration: "800"
                });
        }

        function overviewPage(){
            document.location.href = "index.html";
        }

        $("#loading-text").text("Downloading Crash Data...");

        const og2016 = new XMLHttpRequest();
        og2016.open("GET",
            "https://raw.githubusercontent.com/MattheousDT/crash-ni/master/json/collisions_2016.json",
            false);
        og2016.send();

        const stats2016 = JSON.parse(og2016.response);



        const og2015 = new XMLHttpRequest();
        og2015.open("GET",
            "https://raw.githubusercontent.com/MattheousDT/crash-ni/master/json/collisions_2015.json",
            false);
        og2015.send();

        const stats2015 = JSON.parse(og2015.response);

        const og2014 = new XMLHttpRequest();
        og2014.open("GET",
            "https://raw.githubusercontent.com/MattheousDT/crash-ni/master/json/collisions_2014.json",
            false);
        og2014.send();

        const stats2014 = JSON.parse(og2014.response);

        const og2013 = new XMLHttpRequest();
        og2013.open("GET",
            "https://raw.githubusercontent.com/MattheousDT/crash-ni/master/json/collisions_2013.json",
            false);
        og2013.send();

        const stats2013 = JSON.parse(og2013.response);



        const mymap = L.map('mapid').setView([54.5646351, -6.7517848], 9);

        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
            maxZoom: 18,
            id: 'mapbox.dark',
            accessToken: 'pk.eyJ1IjoibWF0dGhld3dhdHQiLCJhIjoiY2pxOW1wcDhiMzM3NDQ4anl6NW1nYXU4YyJ9.oqCjGPK95L5jPdNkKlR_sQ'
        }).addTo(mymap);

        const markers = L.markerClusterGroup();

        const geo2016 = L.geoJson(stats2016, {
            onEachFeature: function (feature, layer) {

                Number.prototype.pad = function (size) {
                    var s = String(this);
                    while (s.length < (size || 2)) {
                        s = "0" + s;
                    }
                    return s;
                }

                let district = "";
                switch (feature.properties.a_District) {
                    case "ANTN":
                        district = "Antrim and Newtownabbey"
                        break;
                    case "ARBC":
                        district = "Armagh City, Banbridge and Craigavon"
                        break;
                    case "ARND":
                        district = "Ards and North Down"
                        break;
                    case "BELC":
                        district = "Belfast"
                        break;
                    case "CCGL":
                        district = "Causeway Coast and Glens"
                        break;
                    case "DCST":
                        district = "Derry City and Strabane"
                        break;
                    case "FERO":
                        district = "Fermanagh and Omagh"
                        break;
                    case "LISC":
                        district = "Lisburn and Castlereagh"
                        break;
                    case "MEAN":
                        district = "Mid and East Antrim"
                        break;
                    case "MIDU":
                        district = "Mid Ulster"
                        break;
                    case "NEMD":
                        district = "Newry, Mourne and Down"
                        break;
                    default:
                        district = "N/A"
                        break;
                }

                let weekday = "";
                switch (feature.properties.a_wkday) {
                    case "MON":
                        weekday = "Monday"
                        break;
                    case "TUE":
                        weekday = "Tuesday"
                        break;
                    case "WED":
                        weekday = "Wednesday"
                        break;
                    case "THU":
                        weekday = "Thursday"
                        break;
                    case "FRI":
                        weekday = "Friday"
                        break;
                    case "SAT":
                        weekday = "Saturday"
                        break;
                    case "SUN":
                        weekday = "Sunday"
                        break;
                    default:
                        weekday = "N/A"
                        break;
                }

                const date = new Date(feature.properties.a_year, feature.properties.a_month - 1, feature.properties
                    .a_day, feature.properties.a_hour, feature.properties.a_min);

                var options = {
                    day: 'numeric',
                    month: 'long',
                    year: "numeric",
                    year: "numeric",
                    year: "numeric"
                };

                layer.bindPopup(
                    `
                    <h5>Crash #${feature.properties.a_ref} in ${feature.properties.a_year}</h5>
                    <hr>
                <ul>
                    <li><b>Date:</b> ${weekday}, ${date.toLocaleDateString("EN-GB", options)}</li>
                    <li><b>Time:</b> ${feature.properties.a_hour.pad(2) + ":" + feature.properties.a_min.pad(2)}</li>
                    <li><b>District:</b> ${district}</li>
                    <li><b>Speed Limit:</b> ${feature.properties.a_speed}mph</li>
                    <li style="color: #c72417"><b>${feature.properties.a_cas} ${feature.properties.a_cas === 1 ? "casualty" : "casualties"}</b></li>
                </ul>
                `
                );
            }
        });

        const geo2015 = L.geoJson(stats2015, {
            onEachFeature: function (feature, layer) {

                Number.prototype.pad = function (size) {
                    var s = String(this);
                    while (s.length < (size || 2)) {
                        s = "0" + s;
                    }
                    return s;
                }

                let district = "";
                switch (feature.properties.a_District) {
                    case "ANTN":
                        district = "Antrim and Newtownabbey"
                        break;
                    case "ARBC":
                        district = "Armagh City, Banbridge and Craigavon"
                        break;
                    case "ARND":
                        district = "Ards and North Down"
                        break;
                    case "BELC":
                        district = "Belfast"
                        break;
                    case "CCGL":
                        district = "Causeway Coast and Glens"
                        break;
                    case "DCST":
                        district = "Derry City and Strabane"
                        break;
                    case "FERO":
                        district = "Fermanagh and Omagh"
                        break;
                    case "LISC":
                        district = "Lisburn and Castlereagh"
                        break;
                    case "MEAN":
                        district = "Mid and East Antrim"
                        break;
                    case "MIDU":
                        district = "Mid Ulster"
                        break;
                    case "NEMD":
                        district = "Newry, Mourne and Down"
                        break;
                    default:
                        district = "N/A"
                        break;
                }

                let weekday = "";
                switch (feature.properties.a_wkday) {
                    case "MON":
                        weekday = "Monday"
                        break;
                    case "TUE":
                        weekday = "Tuesday"
                        break;
                    case "WED":
                        weekday = "Wednesday"
                        break;
                    case "THU":
                        weekday = "Thursday"
                        break;
                    case "FRI":
                        weekday = "Friday"
                        break;
                    case "SAT":
                        weekday = "Saturday"
                        break;
                    case "SUN":
                        weekday = "Sunday"
                        break;
                    default:
                        weekday = "N/A"
                        break;
                }

                const date = new Date(feature.properties.a_year, feature.properties.a_month - 1, feature.properties
                    .a_day, feature.properties.a_hour, feature.properties.a_min);

                var options = {
                    day: 'numeric',
                    month: 'long',
                    year: "numeric",
                    year: "numeric",
                    year: "numeric"
                };

                layer.bindPopup(
                    `
                    <h5>Crash #${feature.properties.a_ref} in ${feature.properties.a_year}</h5>
                    <hr>
                <ul>
                    <li><b>Date:</b> ${weekday}, ${date.toLocaleDateString("EN-GB", options)}</li>
                    <li><b>Time:</b> ${feature.properties.a_hour.pad(2) + ":" + feature.properties.a_min.pad(2)}</li>
                    <li><b>District:</b> ${district}</li>
                    <li><b>Speed Limit:</b> ${feature.properties.a_speed}mph</li>
                    <li style="color: #c72417"><b>${feature.properties.a_cas} ${feature.properties.a_cas === 1 ? "casualty" : "casualties"}</b></li>
                </ul>
                `
                );
            }
        });

        const geo2014 = L.geoJson(stats2014, {
            onEachFeature: function (feature, layer) {

                Number.prototype.pad = function (size) {
                    var s = String(this);
                    while (s.length < (size || 2)) {
                        s = "0" + s;
                    }
                    return s;
                }

                let district = "";
                switch (feature.properties.a_District) {
                    case "ANTN":
                        district = "Antrim and Newtownabbey"
                        break;
                    case "ARBC":
                        district = "Armagh City, Banbridge and Craigavon"
                        break;
                    case "ARND":
                        district = "Ards and North Down"
                        break;
                    case "BELC":
                        district = "Belfast"
                        break;
                    case "CCGL":
                        district = "Causeway Coast and Glens"
                        break;
                    case "DCST":
                        district = "Derry City and Strabane"
                        break;
                    case "FERO":
                        district = "Fermanagh and Omagh"
                        break;
                    case "LISC":
                        district = "Lisburn and Castlereagh"
                        break;
                    case "MEAN":
                        district = "Mid and East Antrim"
                        break;
                    case "MIDU":
                        district = "Mid Ulster"
                        break;
                    case "NEMD":
                        district = "Newry, Mourne and Down"
                        break;
                    default:
                        district = "N/A"
                        break;
                }

                let weekday = "";
                switch (feature.properties.a_wkday) {
                    case "MON":
                        weekday = "Monday"
                        break;
                    case "TUE":
                        weekday = "Tuesday"
                        break;
                    case "WED":
                        weekday = "Wednesday"
                        break;
                    case "THU":
                        weekday = "Thursday"
                        break;
                    case "FRI":
                        weekday = "Friday"
                        break;
                    case "SAT":
                        weekday = "Saturday"
                        break;
                    case "SUN":
                        weekday = "Sunday"
                        break;
                    default:
                        weekday = "N/A"
                        break;
                }

                const date = new Date(feature.properties.a_year, feature.properties.a_month - 1, feature.properties
                    .a_day, feature.properties.a_hour, feature.properties.a_min);

                var options = {
                    day: 'numeric',
                    month: 'long',
                    year: "numeric",
                    year: "numeric",
                    year: "numeric"
                };

                layer.bindPopup(
                    `
                    <h5>Crash #${feature.properties.a_ref} in ${feature.properties.a_year}</h5>
                    <hr>
                <ul>
                    <li><b>Date:</b> ${weekday}, ${date.toLocaleDateString("EN-GB", options)}</li>
                    <li><b>Time:</b> ${feature.properties.a_hour.pad(2) + ":" + feature.properties.a_min.pad(2)}</li>
                    <li><b>District:</b> ${district}</li>
                    <li><b>Speed Limit:</b> ${feature.properties.a_speed}mph</li>
                    <li style="color: #c72417"><b>${feature.properties.a_cas} ${feature.properties.a_cas === 1 ? "casualty" : "casualties"}</b></li>
                </ul>
                `
                );
            }
        });

        const geo2013 = L.geoJson(stats2013, {
            onEachFeature: function (feature, layer) {

                Number.prototype.pad = function (size) {
                    var s = String(this);
                    while (s.length < (size || 2)) {
                        s = "0" + s;
                    }
                    return s;
                }

                let district = "";
                switch (feature.properties.a_District) {
                    case "ANTN":
                        district = "Antrim and Newtownabbey"
                        break;
                    case "ARBC":
                        district = "Armagh City, Banbridge and Craigavon"
                        break;
                    case "ARND":
                        district = "Ards and North Down"
                        break;
                    case "BELC":
                        district = "Belfast"
                        break;
                    case "CCGL":
                        district = "Causeway Coast and Glens"
                        break;
                    case "DCST":
                        district = "Derry City and Strabane"
                        break;
                    case "FERO":
                        district = "Fermanagh and Omagh"
                        break;
                    case "LISC":
                        district = "Lisburn and Castlereagh"
                        break;
                    case "MEAN":
                        district = "Mid and East Antrim"
                        break;
                    case "MIDU":
                        district = "Mid Ulster"
                        break;
                    case "NEMD":
                        district = "Newry, Mourne and Down"
                        break;
                    default:
                        district = "N/A"
                        break;
                }

                let weekday = "";
                switch (feature.properties.a_wkday) {
                    case "MON":
                        weekday = "Monday"
                        break;
                    case "TUE":
                        weekday = "Tuesday"
                        break;
                    case "WED":
                        weekday = "Wednesday"
                        break;
                    case "THU":
                        weekday = "Thursday"
                        break;
                    case "FRI":
                        weekday = "Friday"
                        break;
                    case "SAT":
                        weekday = "Saturday"
                        break;
                    case "SUN":
                        weekday = "Sunday"
                        break;
                    default:
                        weekday = "N/A"
                        break;
                }

                const date = new Date(feature.properties.a_year, feature.properties.a_month - 1, feature.properties
                    .a_day, feature.properties.a_hour, feature.properties.a_min);

                var options = {
                    day: 'numeric',
                    month: 'long',
                    year: "numeric",
                    year: "numeric",
                    year: "numeric"
                };

                layer.bindPopup(
                    `
                    <h5>Crash #${feature.properties.a_ref} in ${feature.properties.a_year}</h5>
                    <hr>
                <ul>
                    <li><b>Date:</b> ${weekday}, ${date.toLocaleDateString("EN-GB", options)}</li>
                    <li><b>Time:</b> ${feature.properties.a_hour.pad(2) + ":" + feature.properties.a_min.pad(2)}</li>
                    <li><b>District:</b> ${district}</li>
                    <li><b>Speed Limit:</b> ${feature.properties.a_speed}mph</li>
                    <li style="color: #c72417"><b>${feature.properties.a_cas} ${feature.properties.a_cas === 1 ? "casualty" : "casualties"}</b></li>
                </ul>
                `
                );
            }
        });
        $("#loading-text").text("Finishing up!");
        markers.addLayer(geo2016);
        markers.addLayer(geo2015);
        markers.addLayer(geo2014);
        markers.addLayer(geo2013);
        mymap.addLayer(markers);
        mymap.fitBounds(markers.getBounds());
    </script>

</body>

</html>